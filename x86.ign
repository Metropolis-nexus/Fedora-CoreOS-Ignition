{"ignition":{"version":"3.5.0"},"kernelArguments":{"shouldExist":["mitigations=auto,nosmt","nosmt=force","spectre_v2=on","spectre_bhi=on","spec_store_bypass_disable=on","tsx=off","l1d_flush=on","l1tf=full,force","kvm-intel.vmentry_l1d_flush=always","spec_rstack_overflow=safe-ret","gather_data_sampling=force","reg_file_data_sampling=on","kvm.nx_huge_pages=force","amd_iommu=force_isolation","intel_iommu=on","iommu=force","iommu.strict=1","iommu.passthrough=0","efi=disable_early_pci_dma","slab_nomerge","init_on_alloc=1","init_on_free=1","page_alloc.shuffle=1","pti=on","randomize_kstack_offset=on","lockdown=confidentiality","module.sig_enforce=1","oops=panic","vsyscall=none","ia32_emulation=0","debugfs=off","random.trust_bootloader=off","random.trust_cpu=off","console=tty0","console=ttyS0,115200"]},"passwd":{"users":[{"groups":["wheel","sudo"],"name":"tomster","sshAuthorizedKeys":["ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINkTKkJS7Id1WCyA5Klu/moLG9mP5hTC+v2qYqypMF1u contact@tommytran.io"]}]},"storage":{"files":[{"overwrite":true,"path":"/etc/chrony.conf","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/chrony.conf"}},{"overwrite":true,"path":"/etc/sysconfig/chronyd","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/sysconfig/chronyd"}},{"path":"/etc/containers/containers.conf","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/containers/containers.conf"}},{"path":"/etc/docker/daemon.json","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/docker/daemon.json"}},{"overwrite":true,"path":"/etc/issue","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/issue"}},{"overwrite":true,"path":"/etc/issue.net","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/issue"}},{"path":"/etc/modprobe.d/server-blacklist.conf","contents":{"source":"https://raw.githubusercontent.com/secureblue/secureblue/live/files/system/etc/modprobe.d/blacklist.conf"}},{"path":"/etc/security/limits.d/30-disable-coredump.conf","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/security/limits.d/30-disable-coredump.conf"}},{"path":"/etc/ssh/sshd_config.d/10-custom.conf","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/ssh/sshd_config.d/10-custom.conf"}},{"path":"/etc/ssh/ssh_config.d/10-custom.conf","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/ssh/ssh_config.d/10-custom.conf"}},{"path":"/etc/systemd/system/sshd.service.d/override.conf","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/systemd/system/sshd.service.d/override.conf"}},{"path":"/etc/sysctl.d/99-server.conf","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/sysctl.d/99-server.conf"}},{"path":"/etc/systemd/coredump.conf.d","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/systemd/coredump.conf.d/disable.conf"}},{"path":"/etc/systemd/system/gvisor-updater.service","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/systemd/system/gvisor-updater.service"}},{"path":"/etc/systemd/system/NetworkManager.service.d/99-brace.conf","contents":{"source":"https://gitlab.com/divested/brace/-/raw/master/brace/usr/lib/systemd/system/NetworkManager.service.d/99-brace.conf"}},{"path":"/etc/systemd/zram-generator.conf","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/systemd/zram-generator.conf"}},{"path":"/etc/tuned/active_profile","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/tuned/active_profile"}},{"path":"/etc/tuned/profile_mode","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/tuned/profile_mode"}},{"overwrite":true,"path":"/etc/yum.repos.d/_copr:copr.fedorainfracloud.org:secureblue:hardened_malloc.repo","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/yum.repos.d/_copr:copr.fedorainfracloud.org:secureblue:hardened_malloc.repo"}},{"path":"/etc/zincati/config.d/51-rollout-wariness.toml","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/zincati/config.d/51-rollout-wariness.toml"}},{"path":"/etc/zincati/config.d/55-updates-strategy.toml","contents":{"source":"https://raw.githubusercontent.com/Metropolis-nexus/Common-Files/main/etc/zincati/config.d/55-updates-strategy.toml"}}],"links":[{"path":"/etc/systemd/system/multi-user.target.wants/gvisor-updater.service","target":"/etc/systemd/system/gvisor-updater.service"},{"path":"/etc/systemd/system/multi-user.target.wants/tuned.service","target":"/usr/lib/systemd/system/tuned.service"}]},"systemd":{"units":[{"contents":"[Unit]\nDescription=Initial System Setup\n# We run after `systemd-machine-id-commit.service` to ensure that\n# `ConditionFirstBoot=true` services won't rerun on the next boot.\nAfter=systemd-machine-id-commit.service\nAfter=network-online.target\n# We run before `zincati.service` to avoid conflicting rpm-ostree\n# transactions.\nBefore=zincati.service\nConditionPathExists=!/var/lib/%N.stamp\n\n[Service]\nType=oneshot\nRemainAfterExit=yes\nExecStart=/usr/sbin/restorecon -R /var\nExecStart=/usr/sbin/setsebool -P container_use_cephfs off\nExecStart=/usr/sbin/setsebool -P virt_use_nfs off\nExecStart=/usr/sbin/setsebool -P virt_use_samba off\nExecStart=/usr/bin/rpm-ostree install hardened_malloc qemu-guest-agent tuned\nExecStart=/usr/bin/sed -i 's/\\s+nullok//g' /etc/pam.d/system-auth\nExecStart=/usr/bin/systemctl disable systemd-resolved\nExecStart=/usr/bin/rm /etc/resolv.conf\nExecStart=/usr/bin/touch /var/lib/%N.stamp\nExecStart=/usr/bin/echo 'libhardened_malloc.so' \u003e /etc/ld.so.preload\nExecStart=/usr/bin/systemctl --no-block reboot\n\n[Install]\nWantedBy=multi-user.target\n","enabled":true,"name":"postinst.service"},{"enabled":false,"mask":true,"name":"debug-shell.service"},{"enabled":false,"name":"docker.service"},{"enabled":false,"mask":true,"name":"rpm-ostree-countme.timer"},{"enabled":false,"mask":true,"name":"irqbalance.service"},{"enabled":false,"mask":true,"name":"kdump.service"}]}}
